<!DOCTYPE html>
<html>
  <head>
    <title>Record and Listen to Audio</title>
  </head>
  <body>
    <h1>Record and Listen to Audio</h1>
    <div>
      <button id="recordButton">Record</button>
      <button id="stopButton" disabled>Stop</button>
    </div>
    <div>
      <audio id="audioPlayback" controls></audio>
    </div>

    <script>
      // initialize variables
      let mediaRecorder;
      let recordedChunks = [];

      // get the record button and add event listener
      const recordButton = document.getElementById("recordButton");
      recordButton.addEventListener("click", startRecording);

      // get the stop button and add event listener
      const stopButton = document.getElementById("stopButton");
      stopButton.addEventListener("click", stopRecording);

      // function to start recording
      function startRecording() {
        recordedChunks = [];
        navigator.mediaDevices.getUserMedia({ audio: true })
          .then(stream => {
            mediaRecorder = new MediaRecorder(stream);
            mediaRecorder.addEventListener("dataavailable", handleDataAvailable);
            mediaRecorder.start();
            recordButton.disabled = true;
            stopButton.disabled = false;
          })
          .catch(error => {
            console.error("Error accessing microphone:", error);
          });
      }

      // function to handle data available event
      function handleDataAvailable(event) {
        recordedChunks.push(event.data);
      }

      // function to stop recording
      function stopRecording() {
        mediaRecorder.stop();
        recordButton.disabled = false;
        stopButton.disabled = true;
        playRecording();
      }

      // function to play the recorded audio
      function playRecording() {
        const blob = new Blob(recordedChunks, { type: "audio/ogg; codecs=opus" });
        const audioURL = window.URL.createObjectURL(blob);
        const audio = document.getElementById("audioPlayback");
        audio.src = audioURL;
      }
    </script>
  </body>
</html>
